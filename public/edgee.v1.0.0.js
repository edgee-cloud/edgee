(()=>{var E={eventPath:"/_edgee/event",methods:["identify","track","page"]},c=E;var k=t=>{let e=window.location.search;return new URLSearchParams(e).get(t)},y=()=>{let t=k("_edgeedebug");if(t!==null){if(t==="true")return localStorage.setItem("_edgeedebug",!0),!0;if(t==="false")return localStorage.setItem("_edgeedebug",!1),!1}let e=localStorage.getItem("_edgeedebug");return e===null?!1:e==="true"},a=(...t)=>{typeof t!="object"&&(t=[t]),console&&typeof console.log=="function"&&y()&&console.log("%cEDGEE","display: inline-block; color: #61d2a3; background: #231A26; padding: 1px 4px; border-radius: 3px;",...t)},l=(...t)=>{typeof t!="object"&&(t=[t]),console&&typeof console.error=="function"&&y()&&console.error("%cEDGEE","display: inline-block; color: #CB134A; background: #231A26; padding: 1px 4px; border-radius: 3px;",...t)};function x(t){fetch(c.eventPath,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then(e=>{e.status!==200&&e.status!==204?l("Failed to send event to "+c.eventPath+": "+e.status):a("Event sent to "+c.eventPath)}).catch(e=>{l("Failed to send event to "+c.eventPath+": "+e)})}var p=x;var w=0;function d(){let t=document.getElementById("__EDGEE_CONTEXT__");t===null&&w<1&&document.readyState!=="complete"&&(a("Edgee data payload not found, waiting for it to be added to the page"),w++,document.onreadystatechange=()=>{if(document.readyState==="complete")return d()});let e={};if(t!==null){let _=t.textContent;e=JSON.parse(_)}let o=Intl.DateTimeFormat().resolvedOptions().timeZone;o&&(e.client={},e.client.timezone=o);let n=window.screen?window.screen.width:0,r=window.screen?window.screen.height:0;n&&r&&(e.client=e.client||{},e.client.screenWidth=n,e.client.screenHeight=r);let f=window.devicePixelRatio;f&&(e.client=e.client||{},e.client.screenDensity=f);let i=new URLSearchParams(window.location.search);return i.has("utm_campaign")&&(e.campaign=e.campaign||{},e.campaign.name=i.get("utm_campaign")),i.has("utm_source")&&(e.campaign=e.campaign||{},e.campaign.source=i.get("utm_source")),i.has("utm_medium")&&(e.campaign=e.campaign||{},e.campaign.medium=i.get("utm_medium")),i.has("utm_term")&&(e.campaign=e.campaign||{},e.campaign.term=i.get("utm_term")),i.has("utm_content")&&(e.campaign=e.campaign||{},e.campaign.content=i.get("utm_content")),i.has("utm_creative_format")&&(e.campaign=e.campaign||{},e.campaign.creativeFormat=i.get("utm_creative_format")),i.has("utm_marketing_tactic")&&(e.campaign=e.campaign||{},e.campaign.marketingTactic=i.get("utm_marketing_tactic")),e}function P(t){let e=m();if(e.type="page",t.length!==0){let[o,n]=t;typeof o=="string"?e.page.name=o:typeof o=="object"&&(e.page={...e.page,...o}),typeof n=="object"&&(e.destinations={...e.destinations,...n})}a("page event:",e),p(e)}function m(){let t=d(),e;document.querySelector('link[rel="canonical"]')&&document.querySelector('link[rel="canonical"]').getAttribute("href")&&(e=document.querySelector('link[rel="canonical"]').getAttribute("href"),e.indexOf(window.location.protocol+"//")!==0&&(e=window.location.protocol+"//"+window.location.host+e));let o;if(e){o=e.replace(/^https?:\/\//,"");let n=o.split("/")[0];o=o.replace(n,""),o=o.split("?")[0]}if(t.page=t.page||{},t.page.url||(e?t.page.url=e:t.page.url=window.location.protocol+"//"+window.location.host+window.location.pathname+window.location.search),t.page.path||(o?t.page.path=o:t.page.path=window.location.pathname),!t.page.search&&window.location.search!==""&&(t.page.search=window.location.search),t.page.title||(t.page.title=document.title),!t.page.keywords){let n=document.querySelector('meta[name="keywords"]');if(n){let r=n.getAttribute("content");t.page.keywords=r.split(",").map(f=>f.trim())}}return document.referrer&&(t.page.referrer=document.referrer),t}var u=P;function S(t){let e="Event name is required to track an event";if(t.length===0){l(e);return}let o=m();o.type="track",o.track={};let[n,r]=t;if(typeof n=="string")o.track.name=n;else if(typeof n=="object"){if(!n.name){l(e);return}o.track=n}if(n.name===""){l(e);return}typeof r=="object"&&(o.destinations={...o.destinations,...r}),a("track event:",o),p(o)}var v=S;function j(t){let e=d();if(e.type="identify",t.length!==0){let[o,n]=t;typeof o=="string"?e.identify.userId=o:typeof o=="object"&&(e.identify={...e.identify,...o}),typeof n=="object"&&(e.destinations={...e.destinations,...n})}a("identify event:",e),p(e)}var b=j;var s=window.edgee=window.edgee||[];if(s.load)l("Edgee sdk included twice.");else{for(s.load=!0,s.factory=function(n){return function(){let r=Array.prototype.slice.call(arguments);return A(n,r),s}},g=0;g<c.methods.length;g++)h=c.methods[g],s[h]=s.factory(h);let t=document.currentScript,e=t.getAttribute("data-event-path");if(e)a("Event path set to "+e),c.eventPath=e;else{let n=t.src;if(n.startsWith("http://")||n.startsWith("https://")||n.startsWith("//")){n=n.replace("https://",""),n=n.replace("http://",""),n=n.replace("^//","");let r=n.split("/")[0];c.eventPath=`https://${r}/_edgee/event`,a("Event path set to "+c.eventPath)}}let o=t.getAttribute("data-page-event");!o||o!=="false"?(a("Collecting page event client side"),u([])):a("Page event already collected at the edge"),window.dispatchEvent(new Event("edgee:loaded"))}var h,g;function A(t,e){t==="page"?u(e):t==="track"?v(e):t==="identify"&&b(e)}})();
